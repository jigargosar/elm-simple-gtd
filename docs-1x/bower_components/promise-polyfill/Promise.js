function MakePromise(a){function b(j){if('object'!=typeof this||'function'!=typeof j)throw new TypeError;this._state=null,this._value=null,this._deferreds=[],h(j,d.bind(this),f.bind(this))}function c(j){var k=this;return null===this._state?void this._deferreds.push(j):void a(function(){var l=k._state?j.onFulfilled:j.onRejected;if('function'!=typeof l)return void(k._state?j.resolve:j.reject)(k._value);var m;try{m=l(k._value)}catch(n){return void j.reject(n)}j.resolve(m)})}function d(j){try{if(j===this)throw new TypeError;if(j&&('object'==typeof j||'function'==typeof j)){var k=j.then;if('function'==typeof k)return void h(k.bind(j),d.bind(this),f.bind(this))}this._state=!0,this._value=j,g.call(this)}catch(l){f.call(this,l)}}function f(j){this._state=!1,this._value=j,g.call(this)}function g(){for(var j=0,k=this._deferreds.length;j<k;j++)c.call(this,this._deferreds[j]);this._deferreds=null}function h(j,k,l){var m=!1;try{j(function(n){m||(m=!0,k(n))},function(n){m||(m=!0,l(n))})}catch(n){if(m)return;m=!0,l(n)}}return b.prototype['catch']=function(j){return this.then(null,j)},b.prototype.then=function(j,k){var l=this;return new b(function(m,n){c.call(l,{onFulfilled:j,onRejected:k,resolve:m,reject:n})})},b.resolve=function(j){return j&&'object'==typeof j&&j.constructor===b?j:new b(function(k){k(j)})},b.reject=function(j){return new b(function(k,l){l(j)})},b}'undefined'!=typeof module&&(module.exports=MakePromise);