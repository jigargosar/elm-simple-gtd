{"version":3,"sources":["test/javascript/function-scanner_test.ts"],"names":[],"mappings":"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","file":"function-scanner_test.js","sourcesContent":["/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n\nimport {assert} from 'chai';\nimport * as path from 'path';\n\nimport {Visitor} from '../../javascript/estree-visitor';\nimport {ScannedFunction} from '../../javascript/function';\nimport {FunctionScanner} from '../../javascript/function-scanner';\nimport {JavaScriptParser} from '../../javascript/javascript-parser';\nimport {FSUrlLoader} from '../../url-loader/fs-url-loader';\n\nimport {CodeUnderliner} from '../test-utils';\n\nsuite('FunctionScanner', () => {\n  const testFilesDir = path.resolve(__dirname, '../static/namespaces/');\n  const urlLoader = new FSUrlLoader(testFilesDir);\n  const underliner = new CodeUnderliner(urlLoader);\n\n  async function getNamespaceFunctions(filename: string): Promise<any[]> {\n    const file = await urlLoader.load(filename);\n    const parser = new JavaScriptParser();\n    const document = parser.parse(file, filename);\n    const scanner = new FunctionScanner();\n    const visit = (visitor: Visitor) =>\n        Promise.resolve(document.visit([visitor]));\n    const {features} = await scanner.scan(document, visit);\n    return <ScannedFunction[]>features.filter(\n        (e) => e instanceof ScannedFunction);\n  };\n\n\n  async function getTestProps(fn: ScannedFunction):\n      Promise<any> {\n        return {\n          name: fn.name,\n          description: fn.description,\n          summary: fn.summary,\n          warnings: fn.warnings,\n          params: fn.params, return: fn.return,\n          codeSnippet: await underliner.underline(fn.sourceRange),\n          privacy: fn.privacy\n        };\n      }\n\n  test('scans', async() => {\n    const namespaceFunctions =\n        await getNamespaceFunctions('memberof-functions.js');\n    const functionData =\n        await Promise.all(namespaceFunctions.map(getTestProps));\n    assert.deepEqual(functionData, [\n      {\n        name: 'Polymer.aaa',\n        description: 'aaa',\n        summary: '',\n        warnings: [],\n        params: [{\n          desc: 'This is the first argument',\n          name: 'a',\n          type: 'Number',\n        }],\n        privacy: 'public', return: undefined,\n        codeSnippet: `\nfunction aaa(a) {\n~~~~~~~~~~~~~~~~~\n  return a;\n~~~~~~~~~~~\n}\n~`,\n      },\n      {\n        name: 'Polymer.bbb',\n        description: 'bbb',\n        summary: '',\n        warnings: [],\n        params: [], return: undefined,\n        privacy: 'public',\n        codeSnippet: `\nPolymer.bbb = function bbb() {\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n\n};\n~~`,\n      },\n      {\n        name: 'Polymer.ccc',\n        description: 'ccc',\n        summary: '',\n        warnings: [],\n        params: [], return: undefined,\n        privacy: 'protected',\n        codeSnippet: `\n  function ccc() {\n  ~~~~~~~~~~~~~~~~\n  }\n~~~`,\n      },\n      {\n        name: 'Polymer._ddd',\n        description: 'ddd',\n        summary: '',\n        warnings: [],\n        privacy: 'protected',\n        params: [], return: undefined,\n        codeSnippet: `\n  _ddd: function() {\n  ~~~~~~~~~~~~~~~~~~\n\n\n  },\n~~~`,\n      },\n      {\n        name: 'Polymer.eee',\n        description: 'eee',\n        summary: '',\n        warnings: [],\n        params: [], return: undefined,\n        privacy: 'private',\n        codeSnippet: `\n  eee: () => {},\n  ~~~~~~~~~~~~~`,\n      },\n      {\n        name: 'Polymer.fff',\n        description: 'fff',\n        summary: '',\n        warnings: [],\n        params: [], return: undefined,\n        privacy: 'public',\n        codeSnippet: `\n  fff() {\n  ~~~~~~~\n\n\n  },\n~~~`,\n      },\n      {\n        name: 'Polymer.ggg',\n        description: 'ggg',\n        summary: '',\n        warnings: [],\n        params: [], return: undefined,\n        privacy: 'public',\n        codeSnippet: `\n  ggg: someFunction,\n  ~~~~~~~~~~~~~~~~~`,\n      },\n      {\n        name: 'Polymer.hhh_',\n        description: 'hhh_ should be private',\n        summary: '',\n        warnings: [],\n        params: [], return: undefined,\n        privacy: 'private',\n        codeSnippet: `\n  hhh_: someOtherFunc,\n  ~~~~~~~~~~~~~~~~~~~`,\n      },\n      {\n        name: 'Polymer.__iii',\n        description: '__iii should be private too',\n        summary: '',\n        warnings: [],\n        params: [], return: undefined,\n        privacy: 'private',\n        codeSnippet: `\n  __iii() { },\n  ~~~~~~~~~~~`,\n      },\n      {\n        name: 'Polymer.jjj',\n        description: 'jjj',\n        summary: '',\n        warnings: [],\n        params: [], return: undefined,\n        privacy: 'public',\n        codeSnippet: `\nvar jjj = function() {\n~~~~~~~~~~~~~~~~~~~~~~\n\n\n};\n~~`,\n      },\n    ]);\n  });\n});\n"]}